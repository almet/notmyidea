<!DOCTYPE html>
<html lang="en">
  <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <title>Eco-systÃ¨me et stockage gÃ©nÃ©rique - Alexis - Carnets en ligne</title>

    <meta charset="utf-8" />
    <link href="https://blog.notmyidea.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Alexis - Carnets en ligne Full Atom Feed" />
    <link rel="stylesheet" href="https://blog.notmyidea.org/theme/css/poole.css"/>
    <link rel="stylesheet" href="https://blog.notmyidea.org/theme/css/syntax.css"/>
    <link rel="stylesheet" href="https://blog.notmyidea.org/theme/css/lanyon.css"/>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
    <link rel="stylesheet" href="https://blog.notmyidea.org/theme/css/styles.css"/>



<style>

h1 {
    font-family: "Avant Garde", Avantgarde, "Century Gothic", CenturyGothic, "AppleGothic", sans-serif;
    padding: 80px 50px;
    text-align: center;
    text-transform: uppercase;
    text-rendering: optimizeLegibility;
    color: #202020;
    letter-spacing: .1em;
    text-shadow:
        -1px -1px 1px #111,
        2px 2px 1px #eaeaea;
}

h2, h3, h4 {
  text-align: center;
}

#main {
    text-align: justify;
    text-justify: inter-word;
}
#main h1 {
    padding: 10px;
}

.post-headline {
    padding: 15px;
    text-align: center;
}
</style>
  </head>

  <body>
<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="profile">
      <img src="https://blog.notmyidea.org/theme/img/profile.png"/>
    </div>
  </div>

  <nav class="sidebar-nav">
  <a class="sidebar-nav-item" href="/">Articles</a>

  <a class="sidebar-nav-item" href="https://www.vieuxsinge.com">Brasserie du Vieux Singe</a>
  <a class="sidebar-nav-item" href="http://blog.notmyidea.org/pages/about.html">A propos</a>
  <a class="sidebar-nav-item" href="https://twitter.com/ametaireau">Messages courts</a>
  <a class="sidebar-nav-item" href="https://github.com/almet">Code</a>
  </nav>
</div>    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="https://blog.notmyidea.org/" title="Home">Alexis - Carnets en ligne</a>
          </h3>
        </div>
      </div>

      <div class="container content">
<div id="main" class="posts">
<h1 class="post-title">Eco-systÃ¨me et stockage gÃ©nÃ©rique</h1>

<span class="post-date">
    30 avril 2015, dans <a class="no-color" href="category/technologie.html">Technologie</a>
</span>
<img id="illustration" class="illustration-Technologie" src="" />

<div class="post article">
    <div id="toc_container">
      <div class="toc">
<ul>
<li><a href="#eco-systeme-et-stockage-generique">Eco-systÃ¨me et stockage gÃ©nÃ©rique</a><ul>
<li><a href="#remote-storage">Remote Storage</a></li>
<li><a href="#pouchdb">PouchDB</a><ul>
<li><a href="#synchronisation">Synchronisation</a></li>
</ul>
</li>
<li><a href="#le-cas-dutilisation-payments">Le cas d'utilisation Â« Payments Â»</a><ul>
<li><a href="#avec-remotestorage">Avec RemoteStorage</a></li>
<li><a href="#avec-pouchdb">Avec PouchDB</a></li>
</ul>
</li>
<li><a href="#un-nouvel-eco-systeme">Un nouvel Ã©co-systÃ¨me ?</a><ul>
<li><a href="#les-compromis">Les compromis</a></li>
<li><a href="#les-arguments-philosophiques">Les arguments philosophiques</a></li>
<li><a href="#les-arguments-pratiques">Les arguments pratiques</a></li>
</ul>
</li>
<li><a href="#les-prochaines-etapes">Les prochaines Ã©tapes</a></li>
</ul>
</li>
</ul>
</div>

      </div>
    <h1>ğŸŒŸ</h1>
    
<p><strong>tl;dr Nous devons construire un service de suivi de paiements, et nous
hÃ©sitons Ã  continuer Ã  nous entÃªter avec notre propre solution de
stockage/synchronisation.</strong></p>
<p>Comme nous l'Ã©crivions <a href="%7Bfilename%7D/2015.04.service-de-nuages.rst">dans l'article
prÃ©cÃ©dent</a>, nous
souhaitons construire une solution de stockage gÃ©nÃ©rique. On refait
<a href="http://daybed.readthedocs.org">Daybed</a> chez Mozilla !</p>
<p>Notre objectif est simple: permettre aux dÃ©veloppeurs d'application,
internes Ã  Mozilla ou du monde entier, de faire persister et
synchroniser facilement des donnÃ©es associÃ©es Ã  un utilisateur.</p>
<div id="storage-specs">

Les aspects de l'architecture qui nous semblent incontournables:

</div>

<ul>
<li>La solution doit reposer sur un protocole, et non sur une
    implÃ©mentation ;</li>
<li>L'auto-hÃ©bergement de l'ensemble doit Ãªtre simplissime ;</li>
<li>L'authentification doit Ãªtre <em>pluggable</em>, voire dÃ©centralisÃ©e
    (OAuth2, FxA, Persona) ;</li>
<li>Les enregistrements doivent pouvoir Ãªtre validÃ©s par le serveur ;</li>
<li>Les donnÃ©es doivent pouvoir Ãªtre stockÃ©es dans n'importe quel
    backend ;</li>
<li>Un systÃ¨me de permissions doit permettre de protÃ©ger des
    collections, ou de partager des enregistrements de maniÃ¨re fine ;</li>
<li>La rÃ©solution de conflits doit pouvoir avoir lieu sur le serveur ;</li>
<li>Le client doit Ãªtre pensÃ© Â«*offline-first*Â» ;</li>
<li>Le client doit pouvoir rÃ©concilier les donnÃ©es simplement ;</li>
<li>Le client doit pouvoir Ãªtre utilisÃ© aussi bien dans le navigateur
    que cÃ´tÃ© serveur ;</li>
<li>Tous les composants se doivent dÂ´Ãªtre simples et substituables
    facilement.</li>
</ul>
<p>La premiÃ¨re question qui nous a Ã©tÃ© posÃ©e fÃ»t Â«*Pourquoi vous
n'utilisez pas PouchDB ou Remote Storage ?*Â»</p>
<h2 id="remote-storage">Remote Storage</h2>
<p>Remote Storage est un standard ouvert pour du stockage par utilisateur.
<a href="http://tools.ietf.org/html/draft-dejong-remotestorage-04">La
specification</a>
se base sur des standards dÃ©jÃ  existants et Ã©prouvÃ©s: Webfinger, OAuth
2, CORS et REST.</p>
<p>L'API est simple, des <a href="http://blog.cozycloud.cc/news/2014/08/12/when-unhosted-meets-cozy-cloud/">projets prestigieux
l'utilisent</a>.
Il y a plusieurs <a href="https://github.com/jcoglan/restore">implÃ©mentations</a>
du serveur, et il existe <a href="https://www.npmjs.com/package/remotestorage-server">un squelette
Node</a> pour
construire un serveur sur mesure.</p>
<p><img alt="Remote Storage widget" src="%7Bfilename%7D/images/remotestorage-widget.png"></p>
<p>Le client
<a href="https://github.com/remotestorage/remotestorage.js/">remoteStorage.js</a>
permet d'intÃ©grer la solution dans les applications Web. Il se charge du
Â«store localÂ», du cache, de la synchronization, et fournit un widget qui
permet aux utilisateurs des applications de choisir le serveur qui
recevra les donnÃ©es (via Webfinger).</p>
<p><a href="https://github.com/michielbdejong/ludbud">ludbud</a>, la version Ã©purÃ©e de
<em>remoteStorage.js</em>, se limite Ã  l'abstraction du stockage distant. Cela
permettrait Ã  terme, d'avoir une seule bibliothÃ¨que pour stocker dans un
serveur <em>remoteStorage</em>, <em>ownCloud</em> ou chez les mÃ©chants comme <em>Google
Drive</em> ou <em>Dropbox</em>.</p>
<p>Au premier abord, la spÃ©cification correspond Ã  ce que nous voulons
accomplir:</p>
<ul>
<li>La philosophie du protocole est saine;</li>
<li>L'Ã©co-systÃ¨me est bien fichu;</li>
<li>La vision politique colle: redonner le contrÃ´le des donnÃ©es aux
    utilisateurs (voir <a href="http://unhosted.org/">unhosted</a>);</li>
<li>Les choix techniques compatibles avec ce qu'on a commencÃ© (CORS,
    REST, OAuth 2);</li>
</ul>
<p>En revanche, vis Ã  vis de la manipulation des donnÃ©es, il y a plusieurs
diffÃ©rences avec ce que nous souhaitons faire:</p>
<ul>
<li>L'API suit globalement une mÃ©taphore Â«fichiersÂ» (dossier/documents),
    plutÃ´t que Â«donnÃ©esÂ» (collection/enregistrements) ;</li>
<li>Il n'y a pas de validation des enregistrements selon un schÃ©ma (mÃªme
    si <a href="https://remotestorage.io/doc/code/files/baseclient/types-js.html">certaines
    implÃ©mentations</a>
    du protocole le font) ;</li>
<li>Il n'y a pas la possibilitÃ© de trier/filtrer les enregistrements
    selon des attributs ;</li>
<li>Les permissions <a href="https://groups.google.com/forum/#!topic/unhosted/5_NOGq8BPTo">se limitent Ã 
    privÃ©/public</a>
    (et <a href="https://github.com/remotestorage/spec/issues/58#issue-27249452">l'auteur envisage plutÃ´t un modÃ¨le Ã  la
    Git</a>)[1]
    ;</li>
</ul>
<p>En rÃ©sumÃ©, il semblerait que ce que nous souhaitons faire avec le
stockage d'enregistrements validÃ©s est complÃ©mentaire avec <em>Remote
Storage</em>.</p>
<p>Si des besoins de persistence orientÃ©s Â«fichiersÂ» se prÃ©sentent, a
priori nous aurions tort de rÃ©inventer les solutions apportÃ©es par cette
spÃ©cification. Il y a donc de grandes chances que nous lÂ´intÃ©grions Ã 
terme, et que <em>Remote Storage</em> devienne une facette de notre solution.</p>
<h2 id="pouchdb">PouchDB</h2>
<p><a href="http://pouchdb.com/">PouchDB</a> est une bibliothÃ¨que JavaScript qui
permet de manipuler des enregistrements en local et de les synchroniser
vers une base distante.</p>
<p>``` sourceCode javascript
var db = new PouchDB('dbname');</p>
<p>db.put({
 _id: 'dave@gmail.com',
 name: 'David',
 age: 68
});</p>
<p>db.replicate.to('http://example.com/mydb');
```</p>
<p>Le projet a le vent en poupe, bÃ©nÃ©ficie de nombreux contributeurs,
l'Ã©co-systÃ¨me est trÃ¨s riche et l'adoption par des projets <a href="https://github.com/hoodiehq/wip-hoodie-store-on-pouchdb">comme
Hoodie</a> ne fait
que confirmer la pertinence de l'outil pour les dÃ©veloppeurs frontend.</p>
<p><em>PouchDB</em> gÃ¨re un Â« store Â» local, dont la persistence est abstraite et
<a href="http://pouchdb.com/2014/07/25/pouchdb-levels-up.html">repose sur</a> l'API
<a href="https://github.com/level/levelup#relationship-to-leveldown">LevelDown</a>
pour persister les donnÃ©es dans <a href="https://github.com/Level/levelup/wiki/Modules#storage-back-ends">n'importe quel
backend</a>.</p>
<p>MÃªme si <em>PouchDB</em> adresse principalement les besoins des applications
Â«*offline-first*Â», il peut Ãªtre utilisÃ© aussi bien dans le navigateur
que cÃ´tÃ© serveur, via Node.</p>
<h3 id="synchronisation">Synchronisation</h3>
<p>La synchronisation (ou rÃ©plication) des donnÃ©es locales s'effectue sur
un <a href="http://couchdb.apache.org/">CouchDB</a> distant.</p>
<p>Le projet <a href="https://github.com/pouchdb/pouchdb-server">PouchDB Server</a>
implÃ©mente l'API de CouchDB en NodeJS. Comme <em>PouchDB</em> est utilisÃ©, on
obtient un service qui se comporte comme un <em>CouchDB</em> mais qui stocke
ses donnÃ©es n'importe oÃ¹, dans un <em>Redis</em> ou un <em>PostgreSQL</em> par
exemple.</p>
<p>La synchronisation est complÃ¨te. Autrement dit, tous les enregistrements
qui sont sur le serveur se retrouvent synchronisÃ©s dans le client. Il
est possible de filtrer les collections synchronisÃ©es, mais cela <a href="http://pouchdb.com/2015/04/05/filtered-replication.html">n'a
pas pour objectif de sÃ©curiser l'accÃ¨s aux
donnÃ©es</a>.</p>
<p>L'approche recommandÃ©e pour cloisonner les donnÃ©es par utilisateur
consiste Ã  crÃ©er <a href="https://github.com/nolanlawson/pouchdb-authentication#some-people-can-read-some-docs-some-people-can-write-those-same-docs">une base de donnÃ©es par
utilisateur</a>.</p>
<p>Ce n'est pas forcÃ©ment un problÃ¨me, CouchDB <a href="https://mail-archives.apache.org/mod_mbox/couchdb-user/201401.mbox/%3C52CEB873.7080404@ironicdesign.com%3E">supporte des centaines de
milliers de bases sans
sourciller</a>.
Mais selon les cas d'utilisation, le cloisement n'est pas toujours
facile Ã  dÃ©terminer (par rÃ´le, par application, par collection, ...).</p>
<h2 id="le-cas-dutilisation-payments">Le cas d'utilisation Â« Payments Â»</h2>
<p><img alt="Put Payments Here -- Before the Internet - CC-NC-SA Katy Silberger
https://www.flickr.com/photos/katysilbs/11163812186" src="%7Bfilename%7D/images/put-payments.jpg"></p>
<p>Dans les prochaines semaines, nous devrons mettre sur pied un prototype
pour tracer l'historique des paiements et abonnements d'un utilisateur.</p>
<p>Le besoin est simple:</p>
<ul>
<li>l'application Â« Payment Â» enregistre les paiements et abonnements
    d'un utilisateur pour une application donnÃ©e;</li>
<li>l'application Â« DonnÃ©e Â» interroge le service pour vÃ©rifier qu'un
    utilisateur a payÃ© ou est abonnÃ©;</li>
<li>l'utilisateur interroge le service pour obtenir la liste de tous ses
    abonnements.</li>
</ul>
<p>Seule l'application Â« Payment Â» a le droit de crÃ©er/modifier/supprimer
des enregistrements, les deux autres ne peuvent que consulter en lecture
seule.</p>
<p>Une application donnÃ©e ne peut pas accÃ©der aux paiements des autres
applications, et un utilisateur ne peut pas accÃ©der aux paiements des
autres utilisateurs.</p>
<h3 id="avec-remotestorage">Avec RemoteStorage</h3>
<p><img alt="Remote Love - CC-BY-NC Julie
https://www.flickr.com/photos/mamajulie2008/2609549461" src="%7Bfilename%7D/images/remote-love.jpg"></p>
<p>Clairement, l'idÃ©e de <em>RemoteStorage</em> est de dissocier l'application
executÃ©e, et les donnÃ©es crÃ©Ã©es par l'utilisateur avec celle-ci.</p>
<p>Dans notre cas, c'est l'application Â« Payment Â» qui manipule des donnÃ©es
concernant un utilisateur. Mais celles-ci ne lui appartiennent pas
directement: certes un utilisateur doit pouvoir les supprimer, surtout
pas en crÃ©er ou les modifier!</p>
<p>La notion de permissions limitÃ©e Ã  privÃ©/publique ne suffit pas dans ce
cas prÃ©cis.</p>
<h3 id="avec-pouchdb">Avec PouchDB</h3>
<p>Il va falloir crÃ©er une <em>base de donnÃ©es</em> par utilisateur, afin d'isoler
les enregistrements de faÃ§on sÃ©curisÃ©e. Seule l'application Â« Payment Â»
aura tous les droits sur les databases.</p>
<p>Mais cela ne suffit pas.</p>
<p>Il ne faut pas qu'une application puisse voir les paiements des autres
applications, donc il va aussi falloir recloisonner, et crÃ©er une <em>base
de donnÃ©es</em> par application.</p>
<p>Quand un utilisateur voudra accÃ©der Ã  l'ensemble de ses paiements, il
faudra agrÃ©ger les <em>databases</em> de toutes les applications. Quand
l'Ã©quipe marketing voudra faire des statistiques sur l'ensemble des
applications, il faudra agrÃ©gÃ©r des centaines de milliers de
<em>databases</em>.</p>
<p>Ce qui est fort dommage, puisqu'il est probable que les paiements ou
abonnements d'un utilisateur pour une application se comptent sur les
doigts d'une main. Des centaines de milliers de bases contenant moins de
5 enregistrements ?</p>
<p>De plus, dans le cas de l'application Â« Payment Â», le serveur est
implÃ©mentÃ© en Python. Utiliser un wrapper JavaScript comme le fait
<a href="https://pythonhosted.org/Python-PouchDB/">python-pouchdb</a> cela ne nous
fait pas trop rÃªver.</p>
<h2 id="un-nouvel-eco-systeme">Un nouvel Ã©co-systÃ¨me ?</h2>
<p><img alt="Wagon wheel - CC-BY-NC-SA arbyreed
https://www.flickr.com/photos/19779889@N00/16161808220" src="%7Bfilename%7D/images/wagon-wheel.jpg"></p>
<p>Ã‰videmment, quand on voit la richesse des projets <em>PouchDB</em> et <em>Remote
Storage</em> et la dynamique de ces communautÃ©s, il est lÃ©gitime d'hÃ©siter
avant de dÃ©velopper une solution alternative.</p>
<p>Quand nous avons crÃ©Ã© le serveur <em>Reading List</em>, nous l'avons construit
avec <a href="http://cliquet.readthedocs.org/">Cliquet</a>, ce fÃ»t l'occasion de
mettre au point <a href="http://cliquet.readthedocs.org/en/latest/api/">un protocole trÃ¨s
simple</a>, fortement
inspirÃ© de <a href="http://en.wikipedia.org/wiki/Firefox_Sync">Firefox Sync</a>,
pour faire de la synchronisation d'enregistrements.</p>
<p>Et si les clients <em>Reading List</em> ont pu Ãªtre implÃ©mentÃ©s en quelques
semaines, que ce soit en JavaScript, Java (Android) et ASM (Add-on
Firefox), c'est que le principe Â«*offline first*Â» du service est
trivial.</p>
<h3 id="les-compromis">Les compromis</h3>
<p>Ã‰videmment, nous n'avons pas la prÃ©tention de concurrencer <em>CouchDB</em>.
Nous faisons plusieurs concessions:</p>
<ul>
<li>De base, les collections d'enregistrements sont cloisonnÃ©es par
    utilisateur;</li>
<li>Pas d'historique des rÃ©visions;</li>
<li>Pas de diff sur les enregistrements entre rÃ©visions;</li>
<li>De base, pas de rÃ©solution de conflit automatique;</li>
<li>Pas de synchronisation par flux (<em>streams</em>);</li>
</ul>
<p>Jusqu'Ã  preuve du contraire, ces compromis excluent la possibilitÃ©
d'implÃ©menter un <a href="https://github.com/pouchdb/pouchdb/blob/master/lib/adapters/http/http.js#L721-L946">adapter
PouchDB</a>
pour la synchronisation avec le protocole HTTP de <em>Cliquet</em>.</p>
<p>Dommage puisque capitaliser sur l'expÃ©rience client de <em>PouchDB</em> au
niveau synchro client semble Ãªtre une trÃ¨s bonne idÃ©e.</p>
<p>En revanche, nous avons plusieurs fonctionnalitÃ©s intÃ©ressantes:</p>
<ul>
<li>Pas de map-reduce;</li>
<li>Synchronisation partielle et/ou ordonnÃ©e et/ou paginÃ©e ;</li>
<li>Le client choisit, via des headers, d'Ã©craser la donnÃ©e ou de
    respecter la version du serveur ;</li>
<li>Un seul serveur Ã  dÃ©ployer pour N applications ;</li>
<li>Auto-hÃ©bergement simplissime ;</li>
<li>Le client peut choisir de ne pas utiliser de Â« store local Â» du tout
    ;</li>
<li>Dans le client JS, la gestion du Â« store local Â» sera externalisÃ©e
    (on pense Ã  <a href="https://github.com/mozilla/localForage">LocalForage</a> ou
    <a href="https://github.com/dfahlander/Dexie.js">Dexie.js</a>) ;</li>
</ul>
<p>Et, on rÃ©pond au reste des <a href="#storage-specs">specifications mentionnÃ©es au dÃ©but de
l'article</a> !</p>
<h3 id="les-arguments-philosophiques">Les arguments philosophiques</h3>
<p>Il est <a href="http://en.wikipedia.org/wiki/Law_of_the_instrument">illusoire de penser qu'on peut tout faire avec un seul
outil</a>.</p>
<p>Nous avons d'autres cas d'utilisations dans les cartons qui semblent
correspondre au scope de <em>PouchDB</em> (<em>pas de notion de permissions ou de
partage, environnement JavaScript, ...</em>). Nous saurons en tirer profit
quand cela s'avÃ¨rera pertinent !</p>
<p>L'Ã©co-systÃ¨me que nous voulons construire tentera de couvrir les cas
d'utilisation qui sont mal adressÃ©s par <em>PouchDB</em>. Il se voudra:</p>
<ul>
<li>BasÃ© sur notre protocole trÃ¨s simple ;</li>
<li>Minimaliste et multi-usages (<em>comme la fameuse 2CV</em>) ;</li>
<li>NaÃ¯f (<em>pas de rocket science</em>) ;</li>
<li>Sans magie (<em>explicite et facile Ã  rÃ©implÃ©menter from scratch</em>) ;</li>
</ul>
<p><a href="http://cliquet.readthedocs.org/en/latest/rationale.html">La philosophie et les fonctionnalitÃ©s du toolkit python
Cliquet</a> seront
bien entendu Ã  l'honneur :)</p>
<p>Quant Ã  <em>Remote Storage</em>, dÃ¨s que le besoin se prÃ©sentera, nous serons
trÃ¨s fier de rejoindre l'initiative, mais pour l'instant cela nous
paraÃ®t risquÃ© de dÃ©marrer en tordant la solution.</p>
<h3 id="les-arguments-pratiques">Les arguments pratiques</h3>
<p>Avant d'accepter de dÃ©ployer une solution Ã  base de <em>CouchDB</em>, les <em>ops</em>
de Mozilla vont nous demander de leur prouver par A+B que ce n'est pas
faisable avec les stacks qui sont dÃ©jÃ  rodÃ©es en interne (i.e. MySQL,
Redis, PostgreSQL).</p>
<p>De plus, on doit s'engager sur une pÃ©rennitÃ© d'au moins 5 ans pour les
donnÃ©es. Avec <em>Cliquet</em>, en utilisant le backend PostgreSQL, les donnÃ©es
sont persistÃ©es Ã  plat dans un <a href="https://github.com/mozilla-services/cliquet/blob/40aa33/cliquet/storage/postgresql/schema.sql#L14-L28">schÃ©ma PostgreSQL tout
bÃªte</a>.
Ce qui ne sera pas le cas d'un adapteur LevelDown qui va manipuler des
notions de rÃ©visions Ã©clatÃ©es dans un schÃ©ma clÃ©-valeur.</p>
<p>Si nous basons le service sur <em>Cliquet</em>, comme c'est le cas avec
<a href="http://kinto.readthedocs.org">Kinto</a>, tout le travail d'automatisation
de la mise en production (<em>monitoring, builds RPM, Puppet...</em>) que nous
avons fait pour <em>Reading List</em> est complÃ¨tement rÃ©utilisable.</p>
<p>De mÃªme, si on repart avec une stack complÃ¨tement diffÃ©rente, nous
allons devoir recommencer tout le travail de rodage, de profiling et
d'optimisation effectuÃ© au premier trimestre.</p>
<h2 id="les-prochaines-etapes">Les prochaines Ã©tapes</h2>
<p>Et il est encore temps de changer de stratÃ©gie :) Nous aimerions avoir
un maximum de retours ! C'est toujours une dÃ©cision difficile Ã 
prendre... <code>&lt;/appel Ã  troll&gt;</code></p>
<ul>
<li>Tordre un Ã©co-systÃ¨me existant vs. constuire sur mesure ;</li>
<li>MaÃ®triser l'ensemble vs. s'intÃ©grer ;</li>
<li>Contribuer vs. refaire ;</li>
<li>Guider vs. suivre.</li>
</ul>
<p>Nous avons vraiment l'intention de rejoindre l'initiative
<a href="https://nobackend.org/">no-backend</a>, et ce premier pas n'exclue pas que
nous convergions Ã  terme ! Peut-Ãªtre que nous allons finir par rendre
notre service compatible avec <em>Remote Storage</em>, et peut-Ãªtre que
<em>PouchDB</em> deviendra plus agnostique quand au protocole de
synchronisation...</p>
<p><img alt="XKCD â€” Standards
https://xkcd.com/927/" src="%7Bfilename%7D/images/standards.png"></p>
<p>Utiliser ce nouvel Ã©cosystÃ¨me pour le projet Â« Payments Â» va nous
permettre de mettre au point un systÃ¨me de permissions (<em>probablement
basÃ© sur les scopes OAuth</em>) qui correspond au besoin exprimÃ©. Et nous
avons bien l'intention de puiser dans <a href="http://blog.daybed.io/daybed-revival.html">notre expÃ©rience avec Daybed sur
le sujet</a>.</p>
<p>Nous extrairons aussi le code des clients implÃ©mentÃ©s pour <em>Reading
List</em> afin de faire un client JavaScript minimaliste.</p>
<p>En partant dans notre coin, nous prenons plusieurs risques:</p>
<ul>
<li>rÃ©inventer une roue dont nous n'avons pas connaissance ;</li>
<li>Ã©chouer Ã  faire de l'Ã©co-systÃ¨me <em>Cliquet</em> un projet communautaire ;</li>
<li>Ã©chouer Ã  positionner <em>Cliquet</em> dans la niche des cas non couverts
    par PouchDB :)</li>
</ul>
<p>Comme <a href="http://pouchdb.com/2015/04/05/filtered-replication.html">le dit Giovanni
Ornaghi</a>:</p>
<blockquote>
<p>Rolling out your set of webservices, push notifications, or background
services might give you more control, but at the same time it will
force you to engineer, write, test, and maintain a whole new
ecosystem.</p>
</blockquote>
<p>C'est justement l'Ã©co-systÃ¨me dont est responsable l'Ã©quipe <em>Mozilla
Cloud Services</em>!</p>
<ol>
<li>Il existe le <a href="https://sharesome.5apps.com/">projet Sharesome</a> qui
    permet de partager publiquement des ressources de son <em>remote
    Storage</em>.</li>
</ol>
  </div>
</div>
      </div>

      <label for="sidebar-checkbox" class="sidebar-toggle"></label>

      <script>
        (function(document) {
          var i = 0;
          // snip empty header rows since markdown can't
          var rows = document.querySelectorAll('tr');
          for(i=0; i<rows.length; i++) {
            var ths = rows[i].querySelectorAll('th');
            var rowlen = rows[i].children.length;
            if (ths.length > 0 && ths.length === rowlen) {
              rows[i].remove();
            }
          }
        })(document);
      </script>

      <script>
        /* Lanyon & Poole are Copyright (c) 2014 Mark Otto. Adapted to Pelican 20141223 and extended a bit by @thomaswilley */
        (function(document) {
          var toggle = document.querySelector('.sidebar-toggle');
          var sidebar = document.querySelector('#sidebar');
          var checkbox = document.querySelector('#sidebar-checkbox');
          document.addEventListener('click', function(e) {
            var target = e.target;
            if(!checkbox.checked ||
            sidebar.contains(target) ||
            (target === checkbox || target === toggle)) return;
            checkbox.checked = false;
            }, false);
            })(document);
      </script>
      <!-- Piwik -->
      <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
          var u="//tracker.notmyidea.org/";
          _paq.push(['setTrackerUrl', u+'piwik.php']);
          _paq.push(['setSiteId', 3]);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
        })();
      </script>
      <noscript><p><img src="//tracker.notmyidea.org/piwik.php?idsite=3" style="border:0;" alt="" /></p></noscript>
      <!-- End Piwik Code -->
     </div>
  </body>
</html>