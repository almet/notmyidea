<!DOCTYPE html>
<html lang="en">
<head>
        <title>PyconFR 2015 — Geoalchemy - Carnets en ligne</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://blog.notmyidea.org/theme/css/main.css" type="text/css" />
        <link href="https://blog.notmyidea.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Carnets en ligne ATOM Feed" />
</head>
<body>
        <section id="links">
            <li>
                <a class="" href="https://blog.notmyidea.org/" id="site-title">Blog</a>
            </li>
                <li><a class="" href="https://blog.notmyidea.org/pages/projets.html">Projets</a></li>
        </section>





<header>
	<h1 class="post-title">PyconFR 2015 — Geoalchemy</h1>
	<time datetime="2015-10-17T00:00:00+02:00">17 octobre 2015</time>

    
</header>
<article>
    <div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Voici quelques notes prises durant la PyconFR 2015, à Pau. N'hésitez pas
à les completer si besoin.</p>
</div>
<p>Speaker: Eric Lemoine, Camp to camp. (&#64;elemoine)</p>
<p>Bibliothèque python basée sur SQL alchemy, pour interagir avec des bases de
données geographiques / spatiales.</p>
<p>Une base de donnée optimisée pour representer et rechercher des données qui
representent des objets dans un espace géométrique.</p>
<ul class="simple">
<li>Il est possible d estocker des ligne,s de polygones, des points. Il y a une
colonne géometrie pour stocker ces données.</li>
<li>Il y a aussi des fonctions qui permettent de travailler sur ces données
(transfomrations, projections, etc).</li>
<li>Indexs géographiques qui permettent de faire des recherches de manière
performante.</li>
</ul>
<div class="section" id="postgis">
<h2>POSTGIS</h2>
<p>POSTGIS s'appuie sur postres pour offrir des types géographiques, des fonctions
et des indexes (R-Tree), qui permettent de ranger les géométries dans des
&quot;boites englobantes&quot;.</p>
<p>Pour créer une base de données postgis, il faut faire un &quot;create extension
postgis&quot;, ce qui installe tout ce dont on a besoin.</p>
<p>il est possible d'apeller <cite>GEOMETRY(POINT)</cite> par exemple.</p>
<p><cite>ST_GeomFromText('POINT(lat long)')</cite> permet de convertir un point dans un objet
geometrie interne à postgres.</p>
<p><cite>ST_DWithin</cite> permet de trouver les personnes qui sont autour d'un rayon donné.</p>
<p>L'ensemble des fonctions proposées par postgres commencent par <cite>ST_*</cite></p>
</div>
<div class="section" id="sqlalchemy">
<h2>SQLAlchemy</h2>
<p>Il s'agit d'une bote à outil qui permet de faire des requetes de manière
simple. Il y a une philosophie forte.</p>
<ul class="simple">
<li>Il ne sohaite pas cacher la base de données</li>
<li>C'est un language pour faire du SQL en python</li>
<li>Rien n'est caché.</li>
<li>Fourni un vocabulaire riche pour générer le SQL</li>
<li>L'objectif est de changer la manière dont on pense à SQL, redonner le gout du
SQL aux developeurs.</li>
</ul>
<p>Deux parties:
- ORM
- CORE</p>
<p>Il est possible d'utiliser simplement le core si l'on sohaite (sans utiliser
l'ORM)</p>
<div class="section" id="core">
<h3>Core</h3>
<p>Il est possible d'utiliser SQL Alchemy pour générer les tables à l'origine.
Core permet d'utiliser des tables, et d'executer une insertion, depuis python.
Il est possible de representer les requetes avec des methodes chainées
<cite>select().where()</cite> etc.</p>
<p>Le &quot;core&quot; ne fait pas de mapping du tout, il manipule des Tables SQLA
directement.</p>
</div>
<div class="section" id="orm">
<h3>ORM</h3>
<p>L'ORM fait, lui, du mapping. C'est cette couche que l'on va utiliser dans une
application Web complexe par exemple.</p>
<ul class="simple">
<li>il est possible de travailler avec une session <cite>Session()</cite> puis on effectue
des opérations et on <cite>commit()</cite>.</li>
</ul>
<div class="section" id="geoalchemy">
<h4>GeoAlchemy</h4>
<ul class="simple">
<li>Créé en 2009, pour supporter uniquement postgis.</li>
<li>Depuis, d'autres bases de données (MySQL, Spatialite, MySQL server) etc.</li>
<li>Réécriture depuis grace à la nouvelle API de SQLAlechemy, mais perte du
support d'autres backends.</li>
<li>Finalement, retour sur POSTGIS uniquement, pour évite d'avoir à supporter les
différences de tous les backends.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="features">
<h2>Features</h2>
<p>Très simple de s'intégrer avec les features de POSTGIS, par exemple en
déclarant une colonne en tant que &quot;Géometrie&quot;.</p>
<p>Exemple: session.query(Lake).filter(Lake.geom.ST_Buffer(2).ST_Area) permet de
lister l'ensemble des lacs avec une aire de 2 au moins.</p>
<p>S'intègre bien avec des services existants (shapely, pyramid, etc).</p>
<p>Utilisation de geojsondumps pour representer des features en geojson.</p>
</div>
<div class="section" id="status">
<h2>Status</h2>
<p>Le projet est completement documenté sur read the docs. La documentation est
assez complete et solide. Il est intégralement testé, sur differentes versions
de python, sqlalchemy et postgres.</p>
<dl class="docutils">
<dt>3 ou 4 developeurs actifs sur le projet, ça fonctionne plutôt bien. Pour</dt>
<dd><p class="first">contribuer, il est possible de faire cela sur github.</p>
<p class="last">Slides de la presentation sur <a class="reference external" href="http://erliem.net/talks/pyconfr2015">http://erliem.net/talks/pyconfr2015</a></p>
</dd>
</dl>
<p>Resources:</p>
<ul class="simple">
<li><a class="reference external" href="https://pypi.python.org/pypi/Shapely">https://pypi.python.org/pypi/Shapely</a> - Manipulation and analysis of geometric
objects in the Cartesian plane.</li>
</ul>
<p>Question:</p>
<ul class="simple">
<li>Dans les exemples geoalchemy, les données geométriques sont passées sous
forme de chaine. Est-ce normal ? Oui.</li>
<li>Les rasters sont également supportés.</li>
</ul>
</div>

</article>

</body>
</html>